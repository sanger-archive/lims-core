<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Lims::Core::Organization::Order
  
    &mdash; Documentation by YARD 0.7.3
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (O)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../Lims.html" title="Lims (module)">Lims</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Core.html" title="Lims::Core (module)">Core</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Organization.html" title="Lims::Core::Organization (module)">Organization</a></span></span>
     &raquo; 
    <span class="title">Order</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Lims::Core::Organization::Order
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Lims::Core::Organization::Order</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../Resource.html" title="Lims::Core::Resource (module)">Resource</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/lims-core/organization/order.rb<span class="defines">,<br />
  lib/lims-core/actions/create_order.rb,<br /> lib/lims-core/actions/update_order.rb,<br /> lib/lims-core/organization/order/item.rb</span>
</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>An order represents the idea of 'work to be done'. However, an order
focuses more on the final outcomes than the steps to achieve it. The way to
fulfil this order is specified via a `pipeline` and its `parameters`, which
*<b>knows</b>* how to do it. This allows the flexibility for a pipeline to
adapt its process without having to modify the corresponding order. The
current <b>progress</b> of the order - what has been done so far - is then
no stored as "what steps have been done", but more as "which <b>items</b>
exits". To make this work ,we also needs to know how each items
participates in the order, meaning its `role`. For example, in the case
that user U needs sample S to be sequenced, what we need to know is we
<b>have</b> sample S as a *<b>source</b>* and want we want a
<b>sequence</b> as <b>result</b>. To do so, we need to create a library
from the sample. Once this library is created, it becomes part of the order
as *<b>library</b>*. The pipeline will then know that the *<b>library</b>*
has been created and that the next step can start. Note, there is no
relation at a core level between this sample and this library. The pipeline
<b>knows</b> that this *<b>sample</b>* is linked to that *<b>library</b>*.
Ultimately, someone wanted to sequence an existing library, can create an
order with the same parameters, with the *<b>library</b>* given instead of
the *<b>sample</b>*.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>State Machines</h2>

This class contains 1 state machine managed by the state_machine gem.


  <h3>status</h3>
    
    

      <img alt="state machine diagram for state machine status" src="Order_status.png" />

    

<h2>Defined Under Namespace</h2>
<p class="children">
   
    
   
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Order/Item.html" title="Lims::Core::Organization::Order::Item (class)">Item</a></span>
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="Create-constant" class="">Create =
          
        </dt>
        <dd><pre class="code"><span class='const'>Actions</span><span class='op'>::</span><span class='const'>CreateOrder</span></pre></dd>
      
        <dt id="Update-constant" class="">Update =
          
        </dt>
        <dd><pre class="code"><span class='const'>Actions</span><span class='op'>::</span><span class='const'>UpdateOrder</span></pre></dd>
      
    </dl>
  


  
  
  
  


  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%5B%5D-instance_method" title="#[] (instance method)">- (Object) <strong>[]</strong>(key) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<h9>Items ========</h9>

<p>Redirect key to either items or attributes (default Virtus behavior.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#%5B%5D%3D-instance_method" title="#[]= (instance method)">- (Object) <strong>[]=</strong>(key, value) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_item-instance_method" title="#add_item (instance method)">- (Object) <strong>add_item</strong>(role, item) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Add an item to the specified role Ideally, uuid should be unique within a
role.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_source-instance_method" title="#add_source (instance method)">- (Item) <strong>add_source</strong>(role, uuids) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A source is an item required to complete the order.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_target-instance_method" title="#add_target (instance method)">- (Item) <strong>add_target</strong>(role, uuids = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A target is an item produced by the order.</p>
</div></span>
  
</li>

      
        <li class="private ">
  <span class="summary_signature">
    
      <a href="#key_is_for_items%3F-instance_method" title="#key_is_for_items? (instance method)">- (Boolean) <strong>key_is_for_items?</strong>(key) </a>
    

    
  </span>
  
  
  <span class="note title private">private</span>
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Check if the argument is a key for items or attributes.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Resource.html" title="Lims::Core::Resource (module)">Resource</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Resource.html#included-class_method" title="Lims::Core::Resource.included (method)">included</a></span></p>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="[]-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>[]</strong>(key) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<h9>Items ========</h9>

<p>Redirect key to either items or attributes (default Virtus behavior</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/lims-core/organization/order.rb', line 113</span>

<span class='kw'>def</span> <span class='op'>[]</span><span class='lparen'>(</span><span class='id key'>key</span><span class='rparen'>)</span>
  <span class='id key_is_for_items?'>key_is_for_items?</span><span class='lparen'>(</span><span class='id key'>key</span><span class='rparen'>)</span> <span class='op'>?</span> <span class='id items'>items</span><span class='lbracket'>[</span><span class='id key'>key</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='kw'>super</span><span class='lparen'>(</span><span class='id key'>key</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="[]=-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>[]=</strong>(key, value) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/lims-core/organization/order.rb', line 117</span>

<span class='kw'>def</span> <span class='op'>[]=</span><span class='lparen'>(</span><span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id key_is_for_items?'>key_is_for_items?</span><span class='lparen'>(</span><span class='id key'>key</span><span class='rparen'>)</span> 
    <span class='id raise'>raise</span> <span class='const'>RuntimeError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>items should be an array</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id value'>value</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
    <span class='id items'>items</span><span class='lbracket'>[</span><span class='id key'>key</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbracket'>]</span><span class='op'>=</span><span class='id value'>value</span> 
  <span class='kw'>else</span>
    <span class='kw'>super</span><span class='lparen'>(</span><span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_item-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_item</strong>(role, item) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Add an item to the specified role Ideally, uuid should be unique within a
role</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>String</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>role</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>Item</span>
      
      
        <span class='type'></span>
      
      
      
        &mdash;
        <div class='inline'>
<p>item</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


130
131
132
133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/lims-core/organization/order.rb', line 130</span>

<span class='kw'>def</span> <span class='id add_item'>add_item</span><span class='lparen'>(</span><span class='id role'>role</span><span class='comma'>,</span> <span class='id item'>item</span><span class='rparen'>)</span>
  <span class='id role'>role</span> <span class='op'>=</span> <span class='id role'>role</span><span class='period'>.</span><span class='id to_s'>to_s</span>
  <span class='id item_list'>item_list</span> <span class='op'>=</span> <span class='id items'>items</span><span class='period'>.</span><span class='id fetch'>fetch</span><span class='lparen'>(</span><span class='id role'>role</span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id k'>k</span><span class='op'>|</span> <span class='id items'>items</span><span class='lbracket'>[</span><span class='id role'>role</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rbrace'>}</span>
  <span class='id item_list'>item_list</span> <span class='op'>&lt;&lt;</span> <span class='id item'>item</span>
  <span class='kw'>return</span> <span class='id item'>item</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_source-instance_method">
  
    - (<tt><span class='object_link'><a href="Order/Item.html" title="Lims::Core::Organization::Order::Item (class)">Item</a></span></tt>) <strong>add_source</strong>(role, uuids) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>A source is an item required to complete the order. There is nothing to do
for it, so it's already in a done state. As the source is meant to be used
by the pipeline to fulfil the order it needs an underlying object.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>role</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>of the source</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uuids</span>
      
      
        <span class='type'>(<tt>Array</tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>of the underlying object</p>
</div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Order/Item.html" title="Lims::Core::Organization::Order::Item (class)">Item</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


157
158
159
160
161
162
163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/lims-core/organization/order.rb', line 157</span>

<span class='kw'>def</span> <span class='id add_source'>add_source</span><span class='lparen'>(</span><span class='id role'>role</span><span class='comma'>,</span> <span class='id uuids'>uuids</span><span class='rparen'>)</span>
  <span class='id uuids'>uuids</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id uuids'>uuids</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id uuids'>uuids</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
  <span class='id uuids'>uuids</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id uuid'>uuid</span><span class='op'>|</span>
    <span class='const'>Item</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='symbol'>:uuid</span> <span class='op'>=&gt;</span> <span class='id uuid'>uuid</span><span class='rparen'>)</span><span class='period'>.</span><span class='id tap'>tap</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id item'>item</span><span class='op'>|</span>
      <span class='id item'>item</span><span class='period'>.</span><span class='id complete'>complete</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id add_item'>add_item</span><span class='lparen'>(</span><span class='id role'>role</span><span class='comma'>,</span> <span class='id item'>item</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_target-instance_method">
  
    - (<tt><span class='object_link'><a href="Order/Item.html" title="Lims::Core::Organization::Order::Item (class)">Item</a></span></tt>) <strong>add_target</strong>(role, uuids = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>A target is an item produced by the order. It starts as pending and needs
to be completed or failed.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>role</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>of the target</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uuid</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>of the underlying object</p>
</div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Order/Item.html" title="Lims::Core::Organization::Order::Item (class)">Item</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


172
173
174
175
176
177</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/lims-core/organization/order.rb', line 172</span>

<span class='kw'>def</span> <span class='id add_target'>add_target</span><span class='lparen'>(</span><span class='id role'>role</span><span class='comma'>,</span> <span class='id uuids'>uuids</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id uuids'>uuids</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id uuids'>uuids</span><span class='rbracket'>]</span> <span class='kw'>unless</span> <span class='id uuids'>uuids</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Array</span><span class='rparen'>)</span>
  <span class='id uuids'>uuids</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id uuid'>uuid</span><span class='op'>|</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id add_item'>add_item</span><span class='lparen'>(</span><span class='id role'>role</span><span class='comma'>,</span> <span class='const'>Item</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='symbol'>:uuid</span> <span class='op'>=&gt;</span> <span class='id uuid'>uuid</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="key_is_for_items?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>key_is_for_items?</strong>(key)  <span class="extras">(private)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Check if the argument is a key for items or attributes</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>key</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145
146
147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/lims-core/organization/order.rb', line 143</span>

<span class='kw'>def</span> <span class='id key_is_for_items?'>key_is_for_items?</span><span class='lparen'>(</span><span class='id key'>key</span><span class='rparen'>)</span>
  <span class='kw'>case</span> <span class='id key'>key</span>
  <span class='kw'>when</span> <span class='const'>String</span><span class='comma'>,</span> <span class='const'>Symbol</span> <span class='kw'>then</span> <span class='op'>!</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id key'>key</span><span class='rparen'>)</span>
  <span class='kw'>end</span> <span class='op'>||</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    
  </body>
</html>